<% provide(:title, "Bright Idea") %>
<div class="row">
	<div class="col-md-6 col-md-offset-3">
		<h1>Hi, <%= current_user.name %> !</h1>
		<%= form_for(@post) do |f| %>
			<div class="form-group">
				<%= f.text_area :content, rows: "5", placeholder: "Post something with here...", class: "form-control" %>
			</div>
			<div class="form-group text-right">
				<%= f.submit "Post Idea", class: "btn btn-success" %>
			</div>
		<% end %>
	</div>
</div>
<div class="row posts">
	<div class="col-md-6 col-md-offset-3">
		<% @posts.each do |post| %>
		<div class="row post">
			<!-- writer name -->
			<div class="col-sm-3 text-right">
				<p><%= link_to post.user.name, post.user %> Says </p>
				<p class="text-center">
				<% if post.user_id == current_user.id %>
					<%= link_to "Delete", post, method: :delete, data: { confirm: "You sure?" }, class:"btn btn-danger" %>
				<% end %>
			</p>
			</div>

			<!-- post content -->
			<div class="col-sm-9">

				<div class="post-box">
					<%= post.content %>
				</div>

				<div class="like">
					<!-- like or unlike checking for post -->
					<% if !current_user.liking?(post) %>
						<%= form_for(current_user.relationships.build) do |f| %>
							<%= f.hidden_field :user_id, value: current_user.id %>
							<%= f.hidden_field :post_id, value: post.id %>
							<%= f.submit "Like", class: "btn btn-info" %>
						<% end %>
					<% else %>
						<%= form_for(current_user.relationships.find_by(post_id: post.id),
		         html: { method: :delete }) do |f| %>
							<%= f.submit "Unlike", class: "btn btn-warning" %>
						<% end %>
					<% end %>
					
					<a href="/posts/<%= post.id %>">
					<%= pluralize(post.users.count, "person likes", "people like") %>
					</a>
				</div>
			</div>
		</div>
		<% end %>
	</div>
</div>